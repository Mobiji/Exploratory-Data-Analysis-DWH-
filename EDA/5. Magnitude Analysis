/*
=================================================================================================================================
		MAGNITUDE EXPLORATION
=================================================================================================================================
*/

/*
	- Here, I am going to compare the measures by the different categories/dimensions. This will help me understand the
      importance of the various dimensions.
      
	Clause used: aggregate [Measure] by [Dimension]
			  i.e. Total sales by country, Total quantity by category, Total orders by customer etc.
*/

-- Find the total number of customers by country.
select country, count(customer_id) Total_Customers
from gold.dim_customers
group by country
order by Total_Customers desc;
-- Result: The majority of the businesses customers come from the United States.
-- There are 337 customers who dont have their country information.
-- ==============================================================================================================================


-- Find the total number of customers by gender.
select gender, count(customer_id) No_of_customers
from gold.dim_customers
group by gender;
-- Result: The customers are almost grouped 50:50 in the business with the males slightly edging over the females.
-- There are 15 customers who have their gender value as 'n/a'. 
-- ==============================================================================================================================

-- Find the total number of products by category.
select category, count(product_name) Total_Products
from gold.dim_products
group by category;
-- Result: Here the 'Components' category has the most products while the 'Accessories' the least.
-- ==============================================================================================================================

-- What is the average cost for each category ?
select category, round(avg(cost), 2) Avg_cost
from gold.dim_products
group by category
order by Avg_cost desc;
-- Result: The 'Bikes' Category has the highest average cost by far. The 'Accessories' category has the lowest average cost. 
-- ==============================================================================================================================

-- What is the total revenue generated by each category ?
select 	DP.category,
		sum(FS.sales_amount) Total_Revenue
from gold.fact_sales FS
left join gold.dim_products DP
	on FS.product_key = DP.product_key
group by DP.category
order by Total_Revenue desc;
/*
	- 	The 'Bikes' category is BY FAR the best performing category in the business in terms of total revenue generated.
		It generated 28.3 million over a period of 3 years.
	- 	On the other hand, 'Components' was the worst performing category in the business in terms of total revenue generated.
		It generated 0 revenue in the 3 year period.
	- 	The 'Bikes' category disproportionately outperforms the other categories meaning that the business overly relies on
		this category to generate revenue. If anything happens to this category, the business will be in danger of volatility.
*/
-- ==============================================================================================================================

-- Find the total revenue generated by each customer.
select customer_id, customer_name, country, gender, DC.marital_status, sum(sales_amount) Total_Revenue,
		dense_rank() over (order by sum(sales_amount) desc) Overall_ranking
from gold.fact_sales FS
left join gold.dim_customers DC
	on FS.customer_key = DC.customer_key
group by customer_id, customer_name, country, gender, marital_status
order by Total_Revenue desc;

/*
	- 	The customers who have contributed the most to the overall revenue of the business are 'Kaitlyn Henderson'
		and 'Nichole Nara' both tying at a total revenue of 13294. 
	- 	They are closely followed by 'Margaret He' and 'Randall Dominguez' in 2nd and 3rd place respectively.
    - 	Out of the top 10 customers that have generated the most revenue for the business, 7 are females
		and coincidentally, all the 10 come from France. Also, 8 of the top 10 are married individuals.
*/
-- ==============================================================================================================================

-- What is the distribution of sold items across countries ?
select DC.country, count(quantity) Total_Quantity_Sold, sum(FS.sales_amount) Total_Revenue
from gold.fact_sales FS
left join gold.dim_customers DC
	on FS.customer_key = DC.customer_key
group by DC.country
order by Total_Quantity_Sold desc;

/*
	- United States leads this one with 20473 total products being sold to her.
    - On the other hand, France was the least consumer of the businesses products with 5558 total purchased products
*/

/*
=================================================================================================================================
*/
